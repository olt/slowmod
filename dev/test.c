#include <stdio.h>
#include <stdint.h>

int32_t knob_vals[257] = { 20, 29, 38, 46, 54, 63, 71, 79, 86, 94, 102, 109, 116, 124, 131, 138, 145, 151, 158, 164, 171, 177, 184, 190, 196, 202, 208, 213, 219, 225, 230, 235, 241, 246, 251, 256, 261, 266, 271, 276, 280, 285, 290, 294, 298, 303, 307, 311, 315, 319, 323, 327, 331, 335, 339, 342, 346, 350, 353, 357, 360, 363, 367, 370, 373, 376, 379, 382, 385, 388, 391, 394, 397, 400, 402, 405, 408, 562, 567, 572, 578, 584, 590, 596, 603, 610, 618, 626, 634, 642, 651, 661, 671, 681, 692, 703, 715, 728, 741, 755, 769, 784, 800, 817, 834, 852, 871, 891, 912, 934, 957, 981, 1006, 1032, 1060, 1089, 1119, 1151, 1185, 1219, 1256, 1294, 1335, 1377, 1421, 1467, 1515, 1566, 1619, 1675, 1733, 1795, 1859, 1926, 1996, 2070, 2147, 2228, 2313, 2402, 2495, 2592, 2695, 2802, 2914, 3031, 3155, 3284, 3419, 3561, 3709, 3865, 4028, 4199, 4378, 4565, 4762, 4968, 5183, 5409, 5646, 5894, 6154, 6427, 6712, 7011, 7325, 7653, 7997, 8358, 8736, 9131, 9546, 9981, 10436, 10913, 11413, 11937, 12485, 13060, 13663, 14294, 14956, 15649, 16375, 17136, 17933, 18769, 19644, 20561, 21522, 22529, 23584, 24690, 25848, 27061, 28333, 29666, 31062, 32524, 34057, 35663, 37346, 39109, 40957, 65255, 89989, 115170, 140806, 166905, 193477, 220528, 248068, 276107, 304652, 333712, 363298, 393419, 424084, 455304, 487087, 519445, 552388, 585926, 620071, 654832, 690222, 726251, 762932, 800275, 838294, 876999, 916405, 956522, 997364, 1038945, 1081277, 1124374, 1168250, 1212919, 1258395, 1304694, 1351829, 1399816, 1448670, 1498407, 1549043, 1600594, 1653077, 1706509, 1760906, 1816286, 1872668, 1930068, 1988506, 2048000, 2048000 };

// Takes 0-4095 from CV returns
int32_t KnobToHzQ12(int32_t in) {
  int32_t r = in & 0x0f;  // lower 4-bit
  in >>= 4;               // x now 8-bit number, 0-255
  int32_t s1 = knob_vals[in];
  int32_t s2 = knob_vals[in + 1];
  return (s2 * r + s1 * (16 - r)) >> 4;
}

int main() {
    for (int i = 0; i <= 19; ++i) {  // Loop through 20 evenly spaced values
        int32_t knob_val = i * (4095 / 19);  // Calculate knob values in steps
        uint32_t hz = KnobToHzQ12(knob_val);  // Call knobToPeriod
        printf("Knob value: %d -> Hz: %f\n", knob_val, (float)(hz)/0x0fff);  // Print results
    }
    return 0;
}
